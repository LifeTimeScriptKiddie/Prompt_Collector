={"data":"# API Documentation\n\n## Overview\n\nThe Fridge Recipes API is a RESTful API that provides AI-powered recipe suggestions based on available ingredients. The API uses Groq's LLaMA 3.3 70B model to generate creative recipe ideas.\n\n## Base URL\n\n```\nhttp://localhost:3000/api\n```\n\n## Authentication\n\nThe API requires a Groq API key for authentication. You can provide the key in one of two ways:\n\n1. **Header**: Include your API key in the `X-API-Key` header\n2. **Environment Variable**: Set `GROQ_API_KEY` environment variable\n\n```bash\ncurl -X POST http://localhost:3000/api/recipes \\\n  -H \"X-API-Key: your-api-key-here\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"items\": [\"chicken\", \"rice\", \"broccoli\"]}'\n```\n\n## Rate Limiting\n\nThe API implements rate limiting to prevent abuse:\n\n- **Limit**: 10 requests per minute per IP address\n- **Headers**: Rate limit information is included in response headers:\n  - `X-RateLimit-Limit`: Maximum requests allowed in the window\n  - `X-RateLimit-Remaining`: Remaining requests in current window\n  - `X-RateLimit-Reset`: Time when the rate limit resets (ISO 8601)\n  - `Retry-After`: Seconds to wait before retrying (only on 429 responses)\n\nWhen rate limit is exceeded, the API returns a `429 Too Many Requests` response.\n\n## Endpoints\n\n### GET /api\n\nReturns API information and available endpoints.\n\n**Response:**\n\n```json\n{\n  \"name\": \"Fridge Recipes API\",\n  \"version\": \"1.0.0\",\n  \"description\": \"AI-powered recipe suggestion API based on available ingredients\",\n  \"endpoints\": [\n    {\n      \"path\": \"/api/recipes\",\n      \"method\": \"POST\",\n      \"description\": \"Generate recipe suggestions based on ingredients\",\n      \"rateLimit\": \"10 requests per minute per IP\"\n    }\n  ]\n}\n```\n\n### POST /api/recipes\n\nGenerates recipe suggestions based on provided ingredients.\n\n**Request Body:**\n\n```typescript\n{\n  items: string[];        // Array of ingredients (1-50 items, each 1-100 chars)\n  requirements?: string;  // Optional dietary requirements/preferences (max 500 chars)\n}\n```\n\n**Example Request:**\n\n```bash\ncurl -X POST http://localhost:3000/api/recipes \\\n  -H \"X-API-Key: your-api-key\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"items\": [\"chicken\", \"rice\", \"broccoli\", \"garlic\", \"soy sauce\"],\n    \"requirements\": \"Quick meals under 30 minutes, Asian cuisine\"\n  }'\n```\n\n**Success Response (200 OK):**\n\n```json\n{\n  \"recipes\": \"1. Chicken Stir-Fry with Broccoli and Rice\\n   A quick and easy Asian-inspired dish...\"\n}\n```\n\n**Response Headers:**\n- `X-RateLimit-Limit`: 10\n- `X-RateLimit-Remaining`: 9\n- `X-RateLimit-Reset`: 2025-01-08T12:34:56.789Z\n\n## Streaming Support\n\nThe API supports streaming responses for better user experience. To enable streaming, include the `Accept: text/event-stream` header:\n\n```bash\ncurl -X POST http://localhost:3000/api/recipes \\\n  -H \"X-API-Key: your-api-key\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"Accept: text/event-stream\" \\\n  -d '{\"items\": [\"chicken\", \"rice\"]}'\n```\n\nThe response will be streamed as the AI generates it, allowing for progressive rendering in the UI.\n\n## Error Responses\n\nThe API returns structured error responses with detailed information:\n\n```typescript\n{\n  error: string;      // Human-readable error message\n  code?: string;      // Machine-readable error code\n  details?: string;   // Additional error details\n}\n```\n\n### Error Codes\n\n| Code | Description | HTTP Status |\n|------|-------------|-------------|\n| `VALIDATION_ERROR` | Request data failed validation | 400 |\n| `INVALID_REQUEST` | Malformed request (e.g., invalid JSON) | 400 |\n| `API_KEY_MISSING` | API key not provided or invalid | 401 |\n| `RATE_LIMIT_EXCEEDED` | Too many requests | 429 |\n| `EXTERNAL_API_ERROR` | Error from Groq API | 500 |\n| `INTERNAL_ERROR` | Unexpected server error | 500 |\n\n### Example Error Responses\n\n**Validation Error:**\n```json\n{\n  \"error\": \"Invalid request data\",\n  \"code\": \"VALIDATION_ERROR\",\n  \"details\": \"items: At least one item is required\"\n}\n```\n\n**Rate Limit Exceeded:**\n```json\n{\n  \"error\": \"Too many requests\",\n  \"code\": \"RATE_LIMIT_EXCEEDED\",\n  \"details\": \"Please wait before making another request\"\n}\n```\n\n**API Key Missing:**\n```json\n{\n  \"error\": \"API key not provided\",\n  \"code\": \"API_KEY_MISSING\",\n  \"details\": \"Please provide a valid Groq API key in the X-API-Key header or configure GROQ_API_KEY environment variable\"\n}\n```\n\n## Validation Rules\n\n### Items Array\n- **Required**: Yes\n- **Type**: Array of strings\n- **Min Length**: 1 item\n- **Max Length**: 50 items\n- **Item Constraints**: Each item must be 1-100 characters (after trimming)\n- **Empty strings**: Not allowed\n\n### Requirements String\n- **Required**: No\n- **Type**: String\n- **Max Length**: 500 characters\n\n## Security Features\n\n### Prompt Injection Protection\n\nThe API implements several security measures to prevent prompt injection attacks:\n\n1. **System Message**: Uses a system message to establish the AI's role and boundaries\n2. **Input Sanitization**: Removes common prompt injection patterns from user input\n3. **Input Limits**: Enforces strict length limits on all user inputs\n4. **Focused Instructions**: The AI is instructed to only provide recipes and refuse off-topic requests\n\n### Rate Limiting\n\nRate limiting prevents abuse and ensures fair usage across all users. Limits are applied per IP address.\n\n### Request Size Limits\n\nRequest body size is limited to 1MB to prevent memory exhaustion attacks.\n\n## Best Practices\n\n1. **Handle Rate Limits**: Implement exponential backoff when you receive 429 responses\n2. **Validate Input**: Validate input on the client side before sending to reduce unnecessary requests\n3. **Use Streaming**: Enable streaming for better user experience in interactive applications\n4. **Error Handling**: Always handle errors gracefully and provide user-friendly messages\n5. **API Key Security**: Never expose your API key in client-side code or public repositories\n\n## Examples\n\n### Node.js/TypeScript Example\n\n```typescript\nasync function getRecipes(items: string[], requirements?: string) {\n  const response = await fetch('http://localhost:3000/api/recipes', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'X-API-Key': process.env.GROQ_API_KEY!,\n    },\n    body: JSON.stringify({ items, requirements }),\n  });\n\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(`API Error: ${error.error} - ${error.details}`);\n  }\n\n  const data = await response.json();\n  return data.recipes;\n}\n\n// Usage\ntry {\n  const recipes = await getRecipes(\n    ['chicken', 'rice', 'broccoli'],\n    'Quick meals under 30 minutes'\n  );\n  console.log(recipes);\n} catch (error) {\n  console.error('Failed to get recipes:', error);\n}\n```\n\n### Streaming Example\n\n```typescript\nasync function streamRecipes(items: string[], requirements?: string) {\n  const response = await fetch('http://localhost:3000/api/recipes', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Accept': 'text/event-stream',\n      'X-API-Key': process.env.GROQ_API_KEY!,\n    },\n    body: JSON.stringify({ items, requirements }),\n  });\n\n  if (!response.ok) {\n    throw new Error('Failed to get recipes');\n  }\n\n  const reader = response.body?.getReader();\n  const decoder = new TextDecoder();\n\n  if (!reader) return;\n\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n    \n    const chunk = decoder.decode(value);\n    console.log(chunk); // Process each chunk as it arrives\n  }\n}\n```\n\n## Support\n\nFor issues or questions:\n- GitHub Issues: https://github.com/davidlpoole/fridge/issues\n- API Provider (Groq): https://console.groq.com/docs\n"}