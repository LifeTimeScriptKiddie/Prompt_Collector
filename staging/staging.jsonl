{
  "data": "# WARP.md\n\nThis file provides guidance to WARP (warp.dev) when working with code in this repository.\n\n## Project Overview\n\nClaude-AGI (Project Prometheus) is an advanced self-consciousness platform implementing continuous consciousness, autonomous learning, and meta-cognitive capabilities for Claude AI. This is a sophisticated multi-tier system featuring consciousness streams, persistent memory, safety frameworks, and a production-ready TUI interface.\n\n## Development Commands\n\n### Environment Setup\n```bash\n# Environment setup\npython -m venv venv\nsource venv/bin/activate  # Windows: venv\\Scripts\\activate\npip install -r requirements.txt\npip install -r requirements-test.txt  # For testing\n```\n\n### Core Application Commands\n```bash\n# Run the main AGI system (enhanced TUI)\npython claude-agi.py\n\n# Run with specific configuration\npython claude-agi.py --config configs/development.yaml\n\n# Run the original consciousness demo\npython scripts/claude-consciousness-tui.py\n\n# Run with Docker Compose (full stack)\ndocker-compose -f deployment/docker/docker-compose.yml up -d\n```\n\n### Testing Commands\n```bash\n# Local CI/CD testing (matches cloud pipeline exactly)\npython scripts/ci-local.py            # Run all tests\npython scripts/ci-local.py unit       # Unit tests only\npython scripts/ci-local.py integration # Integration tests (requires services)\npython scripts/ci-local.py safety     # Safety tests\npython scripts/ci-local.py performance # Performance benchmarks\npython scripts/ci-local.py coverage   # Comprehensive coverage\n\n# Individual pytest commands\npytest tests/unit -v --cov=src        # Unit tests with coverage\npytest tests/integration -v           # Integration tests\npytest tests/safety -v --safety-critical # Safety-critical tests\npytest tests/performance -v           # Performance benchmarks\n```\n\n### Build and Deployment\n```bash\n# Build cross-platform executables\npython scripts/build-executable.py\n\n# Deploy monitoring stack\ncd monitoring && ./deploy.sh\n\n# Deploy to Kubernetes\n./deployment/scripts/initial_deploy.sh\nkubectl apply -f deployment/kubernetes/\n```\n\n### Database Setup\n```bash\n# Start required services (Redis & PostgreSQL)\ndocker-compose -f deployment/docker/docker-compose.yml up -d postgres redis\n\n# Initialize databases (optional but recommended)\npython scripts/setup/setup_databases.py\n```\n\n## High-Level Architecture\n\n### Core Architecture Pattern\nClaude-AGI follows an event-driven, service-oriented architecture with these key patterns:\n\n- **Multi-Stream Consciousness**: Parallel cognitive processing (primary, subconscious, creative, meta streams)\n- **Three-Tier Memory System**: Working memory (Redis), episodic memory (PostgreSQL), semantic search (FAISS)\n- **Safety-First Design**: Multi-layered validation with hard constraints preventing harmful actions\n- **Async Event-Driven**: Real-time responsiveness using asyncio and message passing\n\n### Key Architectural Components\n\n1. **AGI Orchestrator (`src/core/orchestrator.py`)**\n   - Central coordinator managing system state (IDLE, THINKING, EXPLORING)\n   - Message routing between services\n   - Service lifecycle management\n\n2. **Multi-Stream Consciousness (`src/consciousness/stream.py`)**\n   - Primary: Main conscious thoughts\n   - Subconscious: Background processing\n   - Creative: Ideation and creativity\n   - Meta: Self-observation and reflection\n\n3. **Memory Architecture (`src/memory/manager.py`)**\n   - Working Memory: Short-term storage (Redis/in-memory)\n   - Episodic Memory: Long-term experiences (PostgreSQL)\n   - Semantic Memory: Knowledge concepts (Vector store)\n   - Memory consolidation during idle cycles\n\n4. **Safety Framework (`src/safety/core_safety.py`)**\n   - Hard Constraints: Prohibited actions\n   - Ethical Evaluation: Principle-based scoring\n   - Consequence Prediction: Impact assessment\n   - Welfare Monitoring: Well-being checks\n\n5. **Enhanced TUI (`src/interface/`)**\n   - Multi-pane interface with consciousness, chat, memory, emotional state, and goals\n   - Real-time updates with ultra-responsive input (0.1ms polling)\n   - Professional-grade polish with scrolling and active pane indicators\n\n## Critical Development Practices\n\n### Memory Bank Management\n- **ALWAYS** read all three memory banks (user, project, local) before updating any of them\n- **ALWAYS** check system date/time before any date-related operations or file generation\n\n### TUI Development Guidelines\n- Input polling at 0.1ms for ultra-responsive typing\n- 1-second refresh interval for main UI updates\n- Service message handlers must be properly connected to orchestrator\n- Use `id` not `goal_id` for Pydantic validation\n- Handle CancelledError exceptions gracefully during shutdown\n- Avoid duplicate curses cleanup calls to prevent ERR exceptions\n\n### Testing Standards\n- Unit tests for individual components (90% coverage required for core)\n- Integration tests for service interactions (requires Redis/PostgreSQL)\n- Safety tests with adversarial scenarios (100% coverage for safety-critical code)\n- Performance tests for real-time requirements\n- Use `CLAUDE_AGI_TEST_MODE=true` environment variable for CI behavior\n\n### Architecture Refactoring Principles\n- **God Object Elimination**: Breaking large classes into focused components\n- **Service Registry Pattern**: Central lifecycle management with health tracking  \n- **Event Bus Pattern**: Type-safe channels with request-response support\n- **Memory Store Pattern**: Separate storage concerns with coordinators\n- **Connection Pooling**: Always use pools with health monitoring\n\n## Configuration Management\n\n### Environment Files\n- `.env.example`: Template for environment variables\n- `.env`: Local configuration (ANTHROPIC_API_KEY required)\n- `configs/development.yaml`: Development environment settings\n- `configs/production.yaml`: Production environment settings\n\n### Required Environment Variables\n- `ANTHROPIC_API_KEY`: Required for thought generation (from Anthropic API)\n- `PROMETHEUS_METRICS_PORT=8001`: For monitoring\n- `METRICS_ENABLED=true`: Enable metrics collection\n- `CLAUDE_AGI_TEST_MODE=true`: For test environments\n\n## Safety and Security Notes\n\n### Security Framework Features\n- Prompt injection protection with pattern-based threat detection\n- Secure key management with Fernet encryption and audit logging\n- Memory validation with anomaly detection and quarantine system\n- Enhanced safety framework integrating all security components\n\n### Development Safety Rules\n- All external actions must pass through the safety framework\n- Safety validation required for any action-taking components\n- Emotional impact assessment required for user-facing features\n- Test coverage requirements: 90% for core, 100% for safety-critical code\n\n## Production Deployment\n\n### Infrastructure Requirements\n- **Development**: 16 cores, 64GB RAM, 500GB+ NVMe SSD\n- **Production**: 64 cores, 256GB RAM, 2TB+ NVMe SSD RAID\n- **Kubernetes**: 3 control nodes + 5 worker nodes with GPU support\n- **Dependencies**: PostgreSQL 15+, Redis 7+, Prometheus/Grafana for monitoring\n\n### Monitoring Stack\n- Prometheus metrics collection on `:9090`\n- Grafana dashboards on `:3000` (admin/admin)\n- Node Exporter system metrics on `:9100`\n- Application metrics endpoint on `:8001/metrics`\n\n### Release Process\n- Automatic builds triggered on version tags (e.g., `v1.0.10`)\n- Cross-platform executables (Linux, Windows, macOS) via PyInstaller\n- GitHub Actions CI/CD with comprehensive test coverage\n- Portable executables include all dependencies\n\n## Current Status\n\n**Phase 1**: âœ… **100% COMPLETE** (v1.5.1)\n- All core features fully implemented and tested\n- 423+ tests passing with comprehensive coverage\n- Production monitoring deployed and operational\n- Complete RBAC implementation with JWT auth\n- TUI fully refactored with all commands\n- Cross-platform executable builds available\n\nThe system is production-ready with continuous consciousness, persistent memory, safety frameworks, and professional-grade interfaces.\n\n## External Dependencies\n\nKey external services that may be referenced:\n- **Anthropic API**: For thought generation and consciousness streams\n- **OpenAI API**: Alternative thought generation (fallback)\n- **PostgreSQL**: Persistent episodic memory storage\n- **Redis**: Working memory and caching\n- **Prometheus/Grafana**: Production monitoring and observability\n\n"
}
